# BioStructBenchmark

A CAPRI-compliant tool for analyzing and benchmarking protein-DNA/RNA complex structure predictions against experimental structures. Built primarily for identifying systematic differences between experimentally determined structures and computationally predicted structures generated by programs such as AlphaFold3.

## Features

### CAPRI-Compliant Metrics
BioStructBenchmark implements standard CAPRI (Critical Assessment of PRediction of Interactions) metrics for protein-nucleic acid complex validation:

- **DockQ Score**: Combined quality score [0,1] integrating multiple metrics
- **i-RMSD**: Interface backbone RMSD (Cα/P atoms within 10 Å interface)
- **l-RMSD**: Ligand backbone RMSD after receptor superimposition
- **fnat**: Fraction of native contacts preserved in prediction
- **CAPRI Quality Classification**: Incorrect / Acceptable / Medium / High Quality

### Additional Analysis
- **Structure Alignment**: Optimal superimposition of protein-DNA complexes
- **All-Atom RMSD**: Detailed RMSD calculations for protein and DNA components
- **Per-Residue RMSD**: Identify problematic regions at residue resolution
- **Interface Detection**: Automatic identification of protein-DNA interface residues (10 Å threshold)
- **Error Decomposition**: Separate orientation vs translational errors
- **B-factor/pLDDT Analysis**: Confidence score analysis for predicted structures

### Planned Features
- Consensus error mapping for datasets with incidental mutations
- Principal Component Analysis for systematic error identification
- DNA geometry analysis using CURVES+

## Usage

### Basic Usage

Compare an experimental structure with a predicted structure:

```bash
biostructbenchmark experimental.cif predicted.cif
```

### Save Aligned Structures

Save the aligned structures to an output directory:

```bash
biostructbenchmark experimental.cif predicted.cif --save-structures --output-dir ./results
```

### Example Output

```
=== CAPRI-COMPLIANT METRICS ===
DockQ Score:                 0.723
i-RMSD (Interface Backbone): 1.234 Å
l-RMSD (Ligand Backbone):    2.456 Å
fnat (Native Contacts):      0.785 (78.5%)
Backbone RMSD (Overall):     1.567 Å

DockQ Classification: Medium Quality

=== ALL-ATOM METRICS (Detailed) ===
Overall RMSD:    2.145 Å
Protein RMSD:    1.987 Å
DNA RMSD:        2.543 Å
Interface RMSD:  1.432 Å
```

### Quality Classification

BioStructBenchmark uses DockQ thresholds for quality classification:

| DockQ Score | Quality |
|------------|---------|
| < 0.23 | Incorrect |
| 0.23 - 0.49 | Acceptable |
| 0.49 - 0.80 | Medium Quality |
| ≥ 0.80 | High/Very High Quality |

## File Format Support

- **mmCIF** (.cif) - Preferred format
- **PDB** (.pdb) - Also supported

## CAPRI Compliance

BioStructBenchmark follows CAPRI (Critical Assessment of PRediction of Interactions) standards for protein-nucleic acid complex validation. This ensures metrics are directly comparable with published benchmarks and other validation tools.

**Key CAPRI Standards Implemented:**
- 10 Å interface threshold for interface residue detection
- Backbone atom selection (Cα for protein, P for DNA/RNA)
- 5 Å contact threshold for fnat calculation
- Standard DockQ formula integrating i-RMSD, l-RMSD, and fnat

**References:**
- CAPRI: Janin J, et al. (2003) Proteins 52:2-9
- DockQ: Basu S, Wallner B. (2016) PLoS ONE 11(8):e0161879
- i-RMSD/l-RMSD: Méndez R, et al. (2003) Proteins 52:51-67

## Installation

To install BioStructBenchmark:
```bash
pip install biostructbenchmark
```

## Development

This project uses [uv](https://docs.astral.sh/uv/) for fast, reliable package management.

To set up the development environment:
```bash
# Install uv if you don't have it
curl -LsSf https://astral.sh/uv/install.sh | sh

# Clone and install with dev dependencies
git clone https://github.com/BioStructBenchmark/BioStructBenchmark.git
cd BioStructBenchmark
uv sync

# Run tests
uv run pytest

# Format and lint code
uv run black .
uv run pylint biostructbenchmark
```

