# BioStructBenchmark

A tool for identifying the differences between two sets of structures, in particular DNA-protein complexes.
Built primarily for identifying systematic differences between experimentally determined structures and computationally
predicted structures generated by programs such as AlphaFold3.

## Features

- **Structure Alignment**: Superimpose protein-DNA complexes for comparison
- **RMSD Calculation**: Comprehensive RMSD decomposition (protein, DNA, interface, per-residue)
- **B-factor/pLDDT Analysis**: Compare experimental B-factors with AlphaFold confidence scores
- **Consensus Error Mapping**: Handle datasets with incidental mutations
- **Principal Component Analysis**: Identify systematic differences
- **DNA Geometry Analysis**: Analyze DNA structure using CURVES+

## Installation

To install BioStructBenchmark:
```bash
pip install biostructbenchmark
```

## Usage

### Basic Structure Comparison

```bash
biostructbenchmark experimental.cif predicted.cif
```

This will align the structures and output RMSD metrics for the protein, DNA, and interface regions.

### B-factor/pLDDT Confidence Analysis

Compare experimental B-factors with AlphaFold pLDDT confidence scores:

```bash
biostructbenchmark experimental.cif predicted.cif --analyze-bfactor --output-dir ./results
```

This will generate:
- Console output with summary statistics
- CSV file with per-residue B-factor comparisons at `./results/analysis/bfactor_comparison.csv`

**Understanding the Output:**
- **Mean Experimental B-factor**: Average thermal motion/disorder in experimental structure
- **Mean Predicted Confidence (pLDDT)**: Average AlphaFold confidence (0-100 scale)
- **Correlation**: How well B-factors correlate with pLDDT scores
- **RMSD**: Root mean square difference between B-factors and pLDDT
- **High/Low Confidence Accuracy**: Accuracy in regions with pLDDT > 70 and â‰¤ 70

**CSV Output Format:**
```csv
residue_id,chain_id,position,experimental_bfactor,predicted_confidence,difference,normalized_bfactor
A_1,A,1,25.3,85.2,59.9,-0.5
```

**Notes:**
- Only standard amino acid residues are analyzed; water molecules, ligands, and other heteroatoms are excluded
- For multi-model structures (e.g., NMR ensembles), only the first model is used
- Structures must have >50% non-zero B-factors to pass validation

### Custom Output Location

Specify a custom path for the B-factor CSV:

```bash
biostructbenchmark experimental.cif predicted.cif \
  --analyze-bfactor \
  --bfactor-output my_analysis.csv
```

### Save Aligned Structures

```bash
biostructbenchmark experimental.cif predicted.cif \
  --save-structures \
  --output-dir ./aligned_structures
```

## Development

This project uses [uv](https://docs.astral.sh/uv/) for fast, reliable package management.

To set up the development environment:
```bash
# Install uv if you don't have it
curl -LsSf https://astral.sh/uv/install.sh | sh

# Clone and install with dev dependencies
git clone https://github.com/BioStructBenchmark/BioStructBenchmark.git
cd BioStructBenchmark
uv sync

# Run tests
uv run pytest

# Format and lint code
uv run black .
uv run pylint biostructbenchmark
```

